<div class="users-page">
  <h2>Users</h2>

  <div *ngIf="loading" class="loading">
    <p>Loading users...</p>
  </div>

  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
  </div>

  <div *ngIf="!loading && !error && users.length > 0" class="search-container">
    <div class="search-wrapper">
      <input
        type="text"
        class="search-input"
        placeholder="Search by first name, last name, or email..."
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()"
        [attr.aria-label]="'Search users'">
      <button
        *ngIf="searchQuery"
        type="button"
        class="search-clear"
        (click)="clearSearch()"
        aria-label="Clear search">
        Ã—
      </button>
    </div>
    <p *ngIf="searchQuery && filteredUsers.length === 0" class="no-results">
      No users found matching "{{ searchQuery }}"
    </p>
    <p *ngIf="searchQuery && filteredUsers.length > 0" class="results-count">
      Found {{ filteredUsers.length }} user{{ filteredUsers.length === 1 ? '' : 's' }}
    </p>
  </div>

  <div *ngIf="!loading && !error && users.length === 0" class="no-data">
    <p>No users found.</p>
  </div>

  <div *ngIf="!loading && !error && filteredUsers.length > 0" class="table-container">
    <table class="users-table">
      <thead>
        <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Company Name</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers">
          <td data-label="First Name">{{ getFirstName(user.name) }}</td>
          <td data-label="Last Name">{{ getLastName(user.name) }}</td>
          <td data-label="Phone">{{ user.phone }}</td>
          <td data-label="Email">
            <a [href]="'mailto:' + user.email" class="email-link">{{ user.email }}</a>
          </td>
          <td data-label="Company">{{ user.company.name }}</td>
          <td class="actions-cell" data-label="">
            <button 
              type="button" 
              class="btn btn-posts"
              (click)="viewPosts(user.id)"
              [attr.aria-label]="'View posts for ' + user.name">
              Posts
            </button>
            <button 
              type="button" 
              class="btn btn-todos"
              (click)="viewTodos(user.id)"
              [attr.aria-label]="'View todos for ' + user.name">
              Todos
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
